---
title: 文件共享
description: 文件服务器中的SMB协议详解
slug: file-serve-smb
authors: fish
tags: [笔记, 总结]
date: 2024-08-27
hide_table_of_contents: false
---

文件服务器中的SMB协议详解

<!-- truncate -->

## 文件服务器

文件服务器用于存储文件并使其能够被网络上的多用户或设备访问，它促进协作和数据交换。

### 常见文件共享技术

1. Windows文件共享
   - 在Windows环境中，常用SMB/CIFS协议进行文件共享，它支持Windows客户端和服务器之间的文件共享
2. NFS（网络文件共享）
   - 在UNIX和Linux系统中广泛使用，它允许用户像本地存储一样在网络上查看、存储和更新文件
3. AFP
   - 主要用于苹果设备

## SMB协议

SMB协议是一个应用层网络协议，用于实现文件共享、打印服务

### 基本功能

SMB协议允许计算机在网络上共享文件和打印机资源，不受操作系统平台的限制。

### 版本历史

1. SMB 1.0（CIFS）

   提供基本的文件共享功能，但效率低下安全性较差

2. SMB 2.0

   对1.0进行了性能改进，减少了协议的性能消耗

   改进了对大型文件的支持和网络错误恢复能力

3. SMB 2.1

   性能优化。增加了租约概念以优化客户端缓存

4. SMB 3.0

   添加了更多高级功能，如端到端加密

   支持多通道操作

   集群共享卷（CSV）支持，为服务器集群提供更好的文件共享解决方案

5. SMB 3.1.1

   增加安全性

### 工作原理

SMB协议工作在TCP/IP协议栈的较高层，使用**TCP端口445**通信。

当客户端设备试图通过访问网络上的文件或资源时，它通过SMB协议与服务区建立连接，然后权限验证，通过后可对远程文件执行操作。

### 安全性

随着SMB版本的迭代，其安全性也在得到提升，但由于协议诞生的年代较早，遗留的隐患使其依然成为攻击者利用的目标之一，在生产环境中常常需要关闭445端口

